<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MCDONALD'S EDSA CALOOCAN | Admin Planner</title>
  <link rel="icon" type="image/png" href="mdco.png"> <!-- ‚Üê Favicon added here -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root { --bg-image: url("mcdo_cover.png"); }
body { font-family:'Roboto',sans-serif;margin:0;min-height:100vh;background: linear-gradient(rgba(0,0,0,0.55), rgba(0,0,0,0.55)), var(--bg-image) no-repeat center / cover;display:flex;flex-direction:column;color:#333;}
.top-header { display:flex;justify-content:space-between;align-items:center;padding:18px 30px;background: rgba(0,0,0,0.65);backdrop-filter:blur(6px);color:#fff;box-shadow:0 4px 12px rgba(0,0,0,0.35);}
.header-left { font-size:1.3rem;font-weight:700;}
.home-btn { text-decoration:none;background:#f2c94c;color:#333;padding:8px 18px;border-radius:20px;font-weight:700;}
.home-btn:hover { background:#e0b842;}
main { display:flex;flex-wrap:wrap;justify-content:center;max-width:1200px;margin:25px auto 40px;gap:20px;}
.form-container { flex:1 1 350px;min-width:280px;max-width:400px;background: rgba(255,255,255,0.95);padding:25px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,0.25);}
form { display:flex;flex-direction:column;gap:15px;}
label { font-weight:700;color:#c62828;font-size:0.95rem;}
select,input,textarea { padding:12px;border:2px solid #f2c94c;border-radius:8px;font-size:1em;}
button { background:#f2c94c;color:#333;border:none;padding:12px;border-radius:8px;cursor:pointer;font-weight:700;}
button:hover { background:#e0b842;}
#message { margin-top:10px;font-weight:700;font-size:0.9rem;}
.calendar-container { flex:2 1 600px;min-width:300px;background: rgba(255,255,255,0.95);padding:25px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,0.25);overflow-x:auto;}
#calendar-controls { display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:10px;}
#calendar-controls button { background:#f2c94c;border:none;padding:10px 18px;border-radius:10px;font-weight:700;cursor:pointer;flex:1 1 100px;}
#monthYear { font-size:1.6rem;color:#c62828;font-weight:700;flex:1 1 auto;text-align:center;}
#calendar { display:grid;grid-template-columns:repeat(7,1fr);gap:12px;}
.day-header { text-align:center;font-weight:700;padding:10px 0;background:#c62828;color:#fff;border-radius:8px;font-size:0.9rem;}
.day { background:#fff;border-radius:12px;padding:10px;min-height:135px;box-shadow:0 4px 10px rgba(0,0,0,0.1);position:relative;display:flex;flex-direction:column;}
.today { border:2px solid #c62828;background:#fff8e1;}
.available { background:#e8f5e9;color:#2e7d32;font-size:0.75rem;padding:6px;border-radius:6px;margin-top:6px;font-weight:600;}
.pencil { background: orange;color: #fff;font-size:0.75rem;padding:6px;border-radius:6px;margin-top:6px;font-weight:700;}
.confirmed { background: #2196F3;color:#fff;font-size:0.75rem;padding:6px;border-radius:6px;margin-top:6px;font-weight:700;}
.past { background:#f1f1f1;color:#999;box-shadow:none;pointer-events:none;}
.past::after { content:"PAST";position:absolute;top:8px;right:10px;font-size:0.6rem;background:#bdbdbd;color:#fff;padding:2px 6px;border-radius:6px;font-weight:700;}
.past .available, .past .pencil, .past .confirmed { background:#e0e0e0;color:#9e9e9e;}
.edit-btn, .delete-btn { display:inline-block;margin-left:5px;font-size:0.65rem;padding:2px 5px;border-radius:4px;cursor:pointer;font-weight:700;}
.edit-btn { background:#ffd54f;color:#333;}
.edit-btn:hover { background:#ffc107;}
.delete-btn { background:#e57373;color:#fff;}
.delete-btn:hover { background:#d32f2f;}
hr { border: 1px dashed #999; margin: 6px 0; }
@media(max-width:992px){ main{flex-direction:column;} .form-container,.calendar-container{width:100%; max-width:none;} }
</style>
</head>
<body>
<header class="top-header">
<div class="header-left">üçî MCDONALD'S EDSA CALOOCAN - EVENT PLANNER (Admin)</div>
<a href="https://sites.google.com/view/mcdoedsacaloocan?usp=sharing" class="home-btn">Home</a>
</header>

<main>
<div class="form-container">
<form id="eventForm">
<label for="type">Event Type:</label>
<select id="type" required>
<option value="Party">Party</option>
<option value="Business Meeting">Business Meeting</option>
<option value="Other">Other</option>
</select>

<label for="date">Date:</label>
<input type="date" id="date" required>

<label for="slotContainer">Time Slot:</label>
<div id="slotContainer"></div>

<label for="status">Booking Status:</label>
<select id="status" required>
<option value="Pencil Booking">Pencil Booking</option>
<option value="Confirmed">Confirmed</option>
</select>

<label for="description">Description:</label>
<textarea id="description" placeholder="Event details..."></textarea>

<button type="submit" id="addBtn">Add Event</button>
</form>
<div id="message"></div>
</div>

<div class="calendar-container">
<div id="calendar-controls">
<button id="prevMonth">Prev</button>
<h2 id="monthYear"></h2>
<button id="nextMonth">Next</button>
</div>
<div id="calendar"></div>
</div>
</main>

<script>
let currentDate = new Date();
let editingEvent = null;
const partySlots = [
    {key:"06:00", display:"6:00‚Äì7:30 AM"},
    {key:"09:00", display:"9:00‚Äì10:30 AM"},
    {key:"14:00", display:"2:00‚Äì3:30 PM"},
    {key:"17:00", display:"5:00‚Äì6:30 PM"},
    {key:"20:00", display:"8:00‚Äì9:30 PM"}
];

function loadEvents(){
    let ev=JSON.parse(localStorage.getItem('mcdonaldsEvents')||'{}');
    const today=new Date(); today.setHours(0,0,0,0);
    Object.keys(ev).forEach(d=>{
        Object.keys(ev[d]).forEach(slot=>{
            let e=ev[d][slot];
            if(e.status=='Pencil Booking'){
                let pencilDate=new Date(d);
                pencilDate.setDate(pencilDate.getDate()+7);
                if(today>pencilDate) delete ev[d][slot];
            }
        });
        if(Object.keys(ev[d]).length===0) delete ev[d];
    });
    return ev;
}

function saveEvents(events){ localStorage.setItem('mcdonaldsEvents', JSON.stringify(events)); }

// Convert time string to minutes
function timeToMinutes(t){ const [h,m]=t.split(':'); return parseInt(h)*60+parseInt(m); }

// Check if two time ranges overlap
function isOverlap(start1,end1,start2,end2){
    return !(timeToMinutes(end1)<=timeToMinutes(start2) || timeToMinutes(start1)>=timeToMinutes(end2));
}

function getAvailablePartySlots(date){
    const events = loadEvents();
    const dayEvents = events[date]||{};
    return partySlots.filter(slot=>{
        for(let s in dayEvents){
            const e = dayEvents[s];
            if(e.type!=='Party'){
                const [eStart,eEnd]=s.split('-');
                const [slotStart,slotEnd]=getPartySlotEnd(slot.key); 
                if(isOverlap(slotStart,slotEnd,eStart,eEnd)) return false;
            } else {
                if(s==slot.key) return false;
            }
        }
        return true;
    });
}

// Party slot ends approximate 1.5 hours
function getPartySlotEnd(start){ 
    const [h,m]=start.split(':'); 
    let sh=parseInt(h), sm=parseInt(m); 
    sh+=1; sm+=30; 
    if(sm>=60){ sh+=1; sm-=60; }
    const end = `${String(sh).padStart(2,'0')}:${String(sm).padStart(2,'0')}`;
    return [start,end];
}

function renderTimeSelector(){
    const type = document.getElementById('type').value;
    const slotContainer = document.getElementById('slotContainer');
    slotContainer.innerHTML='';
    const dateVal = document.getElementById('date').value;
    if(type==='Party'){
        const select = document.createElement('select'); select.id='slot'; select.required=true;
        const available = getAvailablePartySlots(dateVal);
        if(available.length===0) select.disabled=true;
        available.forEach(s=>{ const option=document.createElement('option'); option.value=s.key; option.textContent=s.display; select.appendChild(option); });
        slotContainer.appendChild(select);
    } else {
        const start = document.createElement('input'); start.type='time'; start.id='slotStart'; start.required=true;
        const end = document.createElement('input'); end.type='time'; end.id='slotEnd'; end.required=true;
        slotContainer.appendChild(start); slotContainer.appendChild(end);
    }
}

document.getElementById('type').addEventListener('change', renderTimeSelector);
document.getElementById('date').addEventListener('change', renderTimeSelector);
renderTimeSelector();

document.getElementById('eventForm').addEventListener('submit', e=>{
    e.preventDefault();
    const type=document.getElementById('type').value;
    const date=document.getElementById('date').value;
    const status=document.getElementById('status').value;
    const description=document.getElementById('description').value;
    let slot;

    if(type==='Party'){
        slot = document.getElementById('slot').value;
        if(!slot) return alert('No available Party slot');
    } else {
        const start = document.getElementById('slotStart').value;
        const end = document.getElementById('slotEnd').value;
        if(!start||!end) return alert('Select start and end time');
        slot = start+'-'+end;
    }

    const events=loadEvents();
    if(!events[date]) events[date]={};

    if(type!=='Party'){
        for(let s in events[date]){
            const e = events[date][s];
            const [eStart,eEnd]=s.split('-');
            const [newStart,newEnd]=slot.split('-');
            if(isOverlap(newStart,newEnd,eStart,eEnd)){
                return alert('Time overlaps with existing event!');
            }
        }
    }

    if(editingEvent){
        delete events[editingEvent.date][editingEvent.slot];
        editingEvent=null;
        document.getElementById('addBtn').textContent='Add Event';
    }

    events[date][slot]={type,status,description,key:slot};
    saveEvents(events);
    document.getElementById('message').textContent='Event saved successfully!';
    e.target.reset();
    renderTimeSelector();
    renderCalendar();
});

function renderCalendar(){
    const year=currentDate.getFullYear(), month=currentDate.getMonth();
    const daysInMonth=new Date(year,month+1,0).getDate();
    const firstDay=new Date(year,month,1).getDay();
    const today=new Date(); today.setHours(0,0,0,0);
    const calendar=document.getElementById('calendar'); calendar.innerHTML='';
    document.getElementById('monthYear').textContent=`${currentDate.toLocaleString('default',{month:'long'})} ${year}`;
    ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(d=>{ const h=document.createElement('div'); h.className='day-header'; h.textContent=d; calendar.appendChild(h); });
    for(let i=0;i<firstDay;i++){ const empty=document.createElement('div'); empty.className='day'; calendar.appendChild(empty); }

    const events=loadEvents();

    for(let day=1;day<=daysInMonth;day++){
        const dayDiv=document.createElement('div'); dayDiv.className='day';
        const dateObj=new Date(year,month,day); dateObj.setHours(0,0,0,0);
        if(dateObj<today) dayDiv.classList.add('past');
        if(dateObj.getTime()===today.getTime()) dayDiv.classList.add('today');
        dayDiv.innerHTML=`<strong>${day}</strong>`;
        const dateKey=`${year}-${String(month+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
        const dayEvents=events[dateKey]||{};

        // Party slots
        const availableParty = getAvailablePartySlots(dateKey);
        availableParty.forEach(slot=>{
            const slotDiv=document.createElement('div'); slotDiv.className='available';
            slotDiv.textContent=`${slot.display} - Available`;
            dayDiv.appendChild(slotDiv);
        });

        // Separate Pencil / Confirmed
        const pencilEvents = [], confirmedEvents=[];
        Object.keys(dayEvents).forEach(s=>{
            const e=dayEvents[s];
            if(e.status=='Pencil Booking') pencilEvents.push({slot:s,event:e});
            else confirmedEvents.push({slot:s,event:e});
        });

        confirmedEvents.forEach(eObj=>{
            const slotDiv=document.createElement('div'); slotDiv.className='confirmed';
            slotDiv.textContent=`${formatAMPM(eObj.slot)} - ${eObj.event.type} (${eObj.event.status})`;
            addEditDelete(slotDiv,eObj.slot,eObj.event,dateKey);
            dayDiv.appendChild(slotDiv);
        });

        if(pencilEvents.length>0) dayDiv.appendChild(document.createElement('hr'));

        pencilEvents.forEach(eObj=>{
            const slotDiv=document.createElement('div'); slotDiv.className='pencil';
            slotDiv.textContent=`${formatAMPM(eObj.slot)} - ${eObj.event.type} (${eObj.event.status})`;
            addEditDelete(slotDiv,eObj.slot,eObj.event,dateKey);
            dayDiv.appendChild(slotDiv);
        });

        calendar.appendChild(dayDiv);
    }
}

function addEditDelete(slotDiv,slot,event,dateKey){
    const editBtn=document.createElement('span'); editBtn.textContent='Edit'; editBtn.className='edit-btn';
    editBtn.addEventListener('click',()=> {
        document.getElementById('date').value=dateKey;
        document.getElementById('type').value=event.type;
        document.getElementById('status').value=event.status;
        document.getElementById('description').value=event.description;
        editingEvent={date:dateKey, slot:slot};
        renderTimeSelector();
        if(event.type==='Party') document.getElementById('slot').value=slot;
        else {
            const start = document.getElementById('slotStart');
            const end = document.getElementById('slotEnd');
            start.value=slot.split('-')[0]; end.value=slot.split('-')[1];
        }
        document.getElementById('addBtn').textContent='Update Event';
    });
    const deleteBtn=document.createElement('span'); deleteBtn.textContent='Delete'; deleteBtn.className='delete-btn';
    deleteBtn.addEventListener('click',()=>{if(confirm('Delete event?')){const events=loadEvents(); delete events[dateKey][slot]; saveEvents(events); renderCalendar();}});
    slotDiv.appendChild(editBtn); slotDiv.appendChild(deleteBtn);
}

function formatAMPM(slot){
    let start,end;
    if(slot.includes('-')){ [start,end]=slot.split('-'); }
    else { start=slot; end=parseInt(start.split(':')[0])+1+':'+start.split(':')[1]; }
    return toAMPM(start)+'‚Äì'+toAMPM(end);
}

function toAMPM(time){
    let [h,m]=time.split(':'); h=parseInt(h); let ampm=h>=12?'PM':'AM'; h=h%12||12; return h+':'+m+' '+ampm;
}

renderCalendar();
document.getElementById('prevMonth').addEventListener('click',()=>{currentDate.setMonth(currentDate.getMonth()-1); renderCalendar();});
document.getElementById('nextMonth').addEventListener('click',()=>{currentDate.setMonth(currentDate.getMonth()+1); renderCalendar();});
</script>
</body>
</html>
